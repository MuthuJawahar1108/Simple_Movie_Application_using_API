<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Application</title>
    <!-- <script src="./assets/script.js"></script> -->
    <link rel="stylesheet" href="./assets/style.css">
</head>
<body>
    <div class="conatiner">
        <h1>MovieSearch</h1>
        <div class="search">
            <input type="text" placeholder="Search for movies" id="text-box">
            <img src="./assets/images/search-icon.png" alt="search-icon" id="search-icon">
        </div>
        <div class="card">
            <template id="movie-card-template">
                <div class="movie">
                    <div>
                        <p>Year</p>
                    </div>
                    <div>
                        <img src="" alt="Oops! Image not found!">
                    </div>
                    <div>
                        <span>Type</span>
                        <h3>Title</h3>
                    </div>
                </div>
            </template>
        </div>
    </div>
    <script>
        //d6ae06e7
        // Poster: "https://m.media-amazon.com/images/M/MV5BZWQxMjcwNjItZjI0ZC00ZTc4LWIwMzItM2Q0YTZhNzI3NzdlXkEyXkFqcGdeQXVyMTA0MTM5NjI2._V1_SX300.jpg"
        // Title: "Italian Spiderman"
        // Type: "movie"
        // Year: "2007"
        // imdbID: "tt2705436"
        const API_URL = "http://www.omdbapi.com?apikey=d6ae06e7";

        let searchIcon = document.getElementById("search-icon");
        let searchBox = document.getElementById("text-box");
        let movieCardTemplate = document.getElementById("movie-card-template");
        let card = document.getElementsByClassName("card")[0];

        searchIcon.addEventListener("click",async()=>{
            let title = searchBox.value;
            let searchedMovies = await searchMovies(title);
            // console.log(searchedMovies[0]);
            searchedMovies.forEach((movie)=>{
                let movieTemplateClone = document.importNode(movieCardTemplate.content,true);
                let poster = movieTemplateClone.querySelector("img");
                poster.src=movie.Poster;
                let year = movieTemplateClone.querySelector("p");
                year.textContent = movie.Year;
                let type = movieTemplateClone.querySelector("span");
                type.textContent = movie.Type;
                let title = movieTemplateClone.querySelector("h3");
                title.textContent = movie.Title;

                card.appendChild(movieTemplateClone);
            })
        })



        const searchMovies = async(title) => {
            const response = await fetch(`${API_URL}&s=${title}`);
            // console.log(response);
            const data = await response.json();
            const movieArray = await data.Search;

            console.log(movieArray);
            // console.log(data.Search);
            return movieArray;
        }

        searchMovies("Spiderman");
    </script>
</body>
</html>